### START - Platform.sh-specific additions
# Ensure PHP front controller pattern works
DirectoryIndex index.php

# Platform.sh environment detection (keep your rules intact)
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /v/  # Your existing base

    ### Your original rules (unchanged) ###
    RewriteCond %{HTTP_USER_AGENT} bot|crawl|slurp|spider|archive|wget|curl|libwww [NC]
    RewriteRule .* - [F,L]
    RewriteCond %{HTTP_USER_AGENT} ^$
    RewriteRule .* - [F,L]

    RewriteCond %{QUERY_STRING} ^q=.+&rct=.+&sa=.+&cd=.+&ved=.+ [NC]
    RewriteRule ^$ index.php [L]

    RewriteCond %{QUERY_STRING} ^a=.+&.*r=.+ [NC]
    RewriteRule ^$ index.php [L]

    RewriteCond %{REQUEST_URI} !^/index\.php$ [NC]
    RewriteCond %{REQUEST_URI} !^/404\.html$ [NC]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule .* /404.html [L]
    ### End of your original rules ###

    # Platform.sh: Pass all non-static requests to index.php
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^(.*)$ /index.php [L]
</IfModule>
### END - Platform.sh additions

### Your existing security headers (unchanged)
Options -Indexes
<Files .htaccess>
    Order Allow,Deny
    Deny from all
</Files>
<IfModule mod_headers.c>
    Header set X-Frame-Options "SAMEORIGIN"
    Header set X-XSS-Protection "1; mode=block"
    Header set X-Content-Type-Options "nosniff"
</IfModule>
